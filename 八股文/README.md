#### JAVA





####  数据库

##### Redis ：单机10wQPS

核心原理

1、redis的单线程模型

> 1、使用文件事件处理器(包括：多个套接字，IO多路复用、文件事件分派器、事件处理器)，因为文件事件分派器是单线程的，所以redis是单线程的
>
> 2、redis6.0使用多线程：请求接收和解析，以及处理后通过网络返回是使用多线程。命令请求的数据读写还是单线程

2、redis过期删除策略

>a、redisDb数据中，存在一个expires的map，用于存放设置过期时间的key
>
>b、过期策略：惰性删除（访问时先判断是否过期，过期则删除）;redis周期获取一定过期的随机key进行检查，删除
>
>c、从库不会删除过期key，主库删除时同步给从库删除命令。过期期间从库读取(3.2前返回值，3.2从库判断是否过期，过期不返回，但是不删除)

3、redis持久化

> 1、2种持久化方式：RDB(快照-fork子进程把全量数据保存到文件);AOF(记录写命令，追加到AOF末尾。时间长后需要重写--主线程fork子进程，内存也拷贝，读取内存成命令写AOF，过程中的命令会写2份(原来的AOF、重新的AOF))

4、redis内存淘汰机制

> 默认不淘汰，内存不足时报错
>
> volatile前缀是对于设置过期时间的key
>
> allkeys对于所有key
>
> 常用：xxx-LRU(lateset recently used)最近使用；LFU(latest Frequently used)：最不常用；随机；ttl(即将过期)

5、redis分布式部署方式

> 2种方式：保证高可用的redis哨兵模式(sentinel)--主从;扩展存储的cluster模式，使用cluster分片存储，每个分片分配多个hash槽来存储key--去中心

常见问题：



#### 中间件

##### Zookeeper



